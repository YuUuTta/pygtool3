
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>gtplot &#8212; pygtool3  documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pygtool3  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for gtplot</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">ticker</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="k">import</span> <span class="n">LogNorm</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="n">thisdir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisdir</span><span class="p">)</span>   
<span class="kn">import</span> <span class="nn">cartopy_toolkit</span> <span class="k">as</span> <span class="nn">ckit</span>
<span class="kn">from</span> <span class="nn">pygtool_core</span> <span class="k">import</span> <span class="n">Gtool3d</span><span class="p">,</span><span class="n">Gtool2d</span><span class="p">,</span><span class="n">GtoolGrid</span><span class="p">,</span><span class="n">GtoolSigma</span><span class="p">,</span><span class="n">isgtoolinstance</span>

<span class="n">sformat</span><span class="o">=</span><span class="n">ticker</span><span class="o">.</span><span class="n">ScalarFormatter</span><span class="p">(</span><span class="n">useMathText</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nd">@ticker</span><span class="o">.</span><span class="n">FuncFormatter</span>
<span class="k">def</span> <span class="nf">latformatter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">pos</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">y</span><span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">NS</span><span class="o">=</span><span class="s1">&#39;°&#39;</span>
    <span class="k">elif</span> <span class="n">y</span> <span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">NS</span><span class="o">=</span><span class="s1">&#39;°S&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">NS</span><span class="o">=</span><span class="s1">&#39;°N&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{:.0f}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">NS</span><span class="p">)</span>
<span class="nd">@ticker</span><span class="o">.</span><span class="n">FuncFormatter</span>
<span class="k">def</span> <span class="nf">lonformatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">360</span><span class="p">]</span> <span class="p">:</span>
        <span class="n">EW</span><span class="o">=</span><span class="s1">&#39;°&#39;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">):</span>
        <span class="n">EW</span><span class="o">=</span><span class="s1">&#39;°E&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">360</span><span class="o">-</span><span class="n">x</span>
        <span class="n">EW</span><span class="o">=</span><span class="s1">&#39;°W&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{:.0f}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">EW</span><span class="p">)</span>
<div class="viewcode-block" id="set_lonticks"><a class="viewcode-back" href="../gtplot.html#gtplot.set_lonticks">[docs]</a><span class="k">def</span> <span class="nf">set_lonticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">dlon</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    set xticks as logitude</span>
<span class="sd">    </span>
<span class="sd">    Parameter</span>
<span class="sd">    ----------</span>
<span class="sd">    ax  :matplotlib.axes</span>
<span class="sd">    dlon:float</span>
<span class="sd">        logitude interval:30 default</span>
<span class="sd">    labelsize:int </span>
<span class="sd">        tick label size:16 default</span>
<span class="sd">    Return</span>
<span class="sd">    ----------</span>
<span class="sd">    ax</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">dlon</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lonformatter</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>
<div class="viewcode-block" id="set_latticks"><a class="viewcode-back" href="../gtplot.html#gtplot.set_latticks">[docs]</a><span class="k">def</span> <span class="nf">set_latticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">dlat</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    set xticks as latitude</span>
<span class="sd">    </span>
<span class="sd">    Parameter</span>
<span class="sd">    ----------</span>
<span class="sd">    ax  :matplotlib.axes</span>
<span class="sd">    dlat:float</span>
<span class="sd">        logitude interval:15 default</span>
<span class="sd">    labelsize:int</span>
<span class="sd">        tick label size:16 default</span>
<span class="sd">    Return</span>
<span class="sd">    ----------</span>
<span class="sd">    ax</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">dlat</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">latformatter</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>
<div class="viewcode-block" id="YYlabel"><a class="viewcode-back" href="../gtplot.html#gtplot.YYlabel">[docs]</a><span class="k">def</span> <span class="nf">YYlabel</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">month</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">,</span><span class="n">day</span><span class="o">=</span><span class="n">day</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">ax</span> </div>

<div class="viewcode-block" id="MMlabel"><a class="viewcode-back" href="../gtplot.html#gtplot.MMlabel">[docs]</a><span class="k">def</span> <span class="nf">MMlabel</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">(</span><span class="n">bymonth</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%b </span><span class="se">\n</span><span class="s1"> %Y&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">(</span><span class="n">bymonth</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%b&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="DDlabel"><a class="viewcode-back" href="../gtplot.html#gtplot.DDlabel">[docs]</a><span class="k">def</span> <span class="nf">DDlabel</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">(</span><span class="n">bymonth</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%b </span><span class="se">\n</span><span class="s1"> %Y&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">(</span><span class="n">bymonth</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%b&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="contourf"><a class="viewcode-back" href="../gtplot.html#gtplot.contourf">[docs]</a><span class="k">def</span> <span class="nf">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">arr</span><span class="p">,</span><span class="n">cnum</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">clabelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>\
    <span class="n">na_values</span><span class="o">=-</span><span class="mi">999</span><span class="p">,</span><span class="n">replace_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">timestep</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">zsel</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">cyclic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameter</span>
<span class="sd">    ---------------</span>
<span class="sd">    xx,yy  :numpy.ndarray</span>
<span class="sd">    arr    :{numpy.ndarray,Gtool},data</span>
<span class="sd">    cnum    :int or float,default:20</span>
<span class="sd">            the number of contour</span>
<span class="sd">    cmap    :string,colormap name,default:&#39;viridis&#39;</span>
<span class="sd">    extend :string whether fill contour when out of range</span>
<span class="sd">            {both,neither,max,min},default:&#39;both&#39;</span>
<span class="sd">    levels :set contour level manually,default:None</span>
<span class="sd">    alpha  :float{0-1},default:1</span>
<span class="sd">    timestep:int ,model timestep,default:0</span>
<span class="sd">    zsel :int, select model layer for plot,</span>
<span class="sd">    cyclic :bool, cyclic logntiude or not,default:False</span>
<span class="sd">    Return</span>
<span class="sd">    ----------------</span>
<span class="sd">    fig</span>
<span class="sd">    ax</span>
<span class="sd">    cbar</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sformat</span><span class="o">.</span><span class="n">set_powerlimits</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">180</span><span class="p">))</span>
    <span class="n">cax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.05</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ckit</span><span class="o">.</span><span class="n">set_geogrid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">dat</span><span class="o">=</span><span class="n">isgtoolinstance</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span><span class="n">cyclic</span><span class="o">=</span><span class="n">cyclic</span><span class="p">,</span><span class="n">zsel</span><span class="o">=</span><span class="n">zsel</span><span class="p">,</span><span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
            <span class="n">na_values</span><span class="o">=</span><span class="n">na_values</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">delta</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">dat</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span>
        <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">dat</span><span class="p">),</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">dat</span><span class="p">))</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span><span class="n">delta</span><span class="p">,</span><span class="n">delta</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">cf</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">dat</span>
        <span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">levels</span>
        <span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extend</span>
        <span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span>
        <span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span>
        <span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">cbar</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span><span class="n">cax</span>
<span class="c1">#        ,ticks=interval[::2]</span>
        <span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="n">sformat</span>
        <span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>

    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">cbar</span></div>
<div class="viewcode-block" id="logcontourf"><a class="viewcode-back" href="../gtplot.html#gtplot.logcontourf">[docs]</a><span class="k">def</span> <span class="nf">logcontourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">arr</span><span class="p">,</span><span class="n">subs</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,),</span><span class="n">clabelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>\
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">offsetTextsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>\
    <span class="n">na_values</span><span class="o">=-</span><span class="mi">999</span><span class="p">,</span><span class="n">replace_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">timestep</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">cyclic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">zsel</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameter</span>
<span class="sd">    ---------------</span>
<span class="sd">    xx,yy  :array_like</span>
<span class="sd">    arr    :{Gtool2d,Gtool3d,numpy.ndarray},model data</span>
<span class="sd">    subs   :{sequence of float, &#39;all&#39;,&#39;auto&#39;,None}</span>
<span class="sd">           default=(1,) ex) (1.0,2.0) </span>
<span class="sd">    cmap   :string colormap</span>
<span class="sd">    vmin   :float,minimum value,default=arr.min()</span>
<span class="sd">    vmax   :float,maximum value,default=arr.max()</span>
<span class="sd">    alpha  :float, 0-1 ,default=1</span>
<span class="sd">    extend :string {&#39;max&#39;,&#39;min&#39;,&#39;both&#39;,&#39;neither&#39;}</span>
<span class="sd">    timestep:int</span>
<span class="sd">    zsel:int</span>
<span class="sd">    cyclic:bool</span>
<span class="sd">    Return</span>
<span class="sd">    ----------------</span>
<span class="sd">    fig :matplotlib.Figure</span>
<span class="sd">    ax  :matplotlib.axes</span>
<span class="sd">    cbar:matplotlib.colorbar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">180</span><span class="p">))</span>
    <span class="n">cax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.05</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ckit</span><span class="o">.</span><span class="n">set_geogrid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">dat</span><span class="o">=</span><span class="n">isgtoolinstance</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span><span class="n">cyclic</span><span class="o">=</span><span class="n">cyclic</span><span class="p">,</span><span class="n">zsel</span><span class="o">=</span><span class="n">zsel</span><span class="p">,</span><span class="n">na_values</span><span class="o">=</span><span class="n">na_values</span><span class="p">,</span><span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>

    <span class="n">cf</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">dat</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">locator</span><span class="o">=</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="n">subs</span><span class="p">),</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">cbar</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span><span class="n">cax</span><span class="p">,</span>
        <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span>
        <span class="n">ticks</span><span class="o">=</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,)),</span>
        <span class="nb">format</span><span class="o">=</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogFormatterSciNotation</span><span class="p">(),</span>
        <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">offsetTextsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">cbar</span></div>
<div class="viewcode-block" id="pcolormesh"><a class="viewcode-back" href="../gtplot.html#gtplot.pcolormesh">[docs]</a><span class="k">def</span> <span class="nf">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">arr</span><span class="p">,</span><span class="n">subs</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,),</span><span class="n">clabelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>\
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span>\
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">offsetTextsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>\
    <span class="n">na_values</span><span class="o">=-</span><span class="mi">999</span><span class="p">,</span><span class="n">replace_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">timestep</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">cyclic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">zsel</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameter</span>
<span class="sd">    ---------------</span>
<span class="sd">    xx,yy  :array_like</span>
<span class="sd">    arr    :{Gtool2d,Gtool3d,numpy.ndarray},model data</span>
<span class="sd">    subs   :{sequence of float, &#39;all&#39;,&#39;auto&#39;,None}</span>
<span class="sd">           default=(1,) ex) (1.0,2.0) </span>
<span class="sd">    cmap   :string colormap</span>
<span class="sd">    vmin   :float,minimum value,default=arr.min()</span>
<span class="sd">    vmax   :float,maximum value,default=arr.max()</span>
<span class="sd">    alpha  :float, 0-1 ,default=1</span>
<span class="sd">    extend :string {&#39;max&#39;,&#39;min&#39;,&#39;both&#39;,&#39;neither&#39;}</span>
<span class="sd">    scale  :string ,{&#39;normal&#39;,&#39;log&#39;}</span>
<span class="sd">    Return</span>
<span class="sd">    ----------------</span>
<span class="sd">    fig :matplotlib.Figure</span>
<span class="sd">    ax  :matplotlib.axes</span>
<span class="sd">    cbar:matplotlib.colorbar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">180</span><span class="p">))</span>
    <span class="n">cax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.05</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ckit</span><span class="o">.</span><span class="n">set_geogrid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">dat</span><span class="o">=</span><span class="n">isgtoolinstance</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span><span class="n">cyclic</span><span class="o">=</span><span class="n">cyclic</span><span class="p">,</span><span class="n">zsel</span><span class="o">=</span><span class="n">zsel</span><span class="p">,</span><span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span><span class="n">na_values</span><span class="o">=</span><span class="n">na_values</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
    <span class="n">norm</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;normal&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;log&#39;</span><span class="p">:</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)}</span>
    <span class="n">cf</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">dat</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">[</span><span class="n">scale</span><span class="p">],</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">scale</span><span class="o">==</span><span class="s1">&#39;log&#39;</span><span class="p">:</span>
        <span class="n">cbar</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span><span class="n">cax</span><span class="p">,</span>
            <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span>
            <span class="n">ticks</span><span class="o">=</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="n">subs</span><span class="p">),</span>
            <span class="nb">format</span><span class="o">=</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogFormatterSciNotation</span><span class="p">(),</span>
            <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cbar</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span><span class="n">cax</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">offsetTextsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">cbar</span></div>
<div class="viewcode-block" id="zonal_contourf"><a class="viewcode-back" href="../gtplot.html#gtplot.zonal_contourf">[docs]</a><span class="k">def</span> <span class="nf">zonal_contourf</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span><span class="n">zz</span><span class="p">,</span><span class="n">arr</span><span class="p">,</span><span class="n">cnum</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">clabelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
            <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span><span class="n">powerlimits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>\
            <span class="n">dlat</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
            <span class="n">na_values</span><span class="o">=-</span><span class="mi">999</span><span class="p">,</span><span class="n">replace_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;eta&#39;</span><span class="p">,</span>
            <span class="n">timestep</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">xsel</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">cyclic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameter</span>
<span class="sd">    ---------------</span>
<span class="sd">    yy,zz  :array_like</span>
<span class="sd">    xsel   :{int ,string},{index of logitude,&#39;mean&#39;} </span>
<span class="sd">    arr    :array_like</span>
<span class="sd">            input data</span>
<span class="sd">    cnum    :int or float</span>
<span class="sd">            the number of contour</span>
<span class="sd">    powerlimits:tuple</span>
<span class="sd">           exponent range</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Return</span>
<span class="sd">    ----------------</span>
<span class="sd">    fig</span>
<span class="sd">    ax</span>
<span class="sd">    cbar</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sformat</span><span class="o">.</span><span class="n">set_powerlimits</span><span class="p">((</span><span class="n">powerlimits</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.05</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">Gtool3d</span><span class="p">):</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">getarr</span><span class="p">(</span><span class="n">cyclic</span><span class="o">=</span><span class="n">cyclic</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span><span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span><span class="n">na_values</span><span class="o">=</span><span class="n">na_values</span><span class="p">)[:,:,:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">arr</span><span class="p">[:,:,:]</span>
    <span class="k">if</span> <span class="n">xsel</span><span class="o">==</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">dat</span><span class="p">[:,:,:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">dat</span><span class="p">[:,:,</span><span class="n">xsel</span><span class="p">]</span>
    <span class="n">set_latticks</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">dlat</span><span class="o">=</span><span class="n">dlat</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">delta</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">dat</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span>
        <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">dat</span><span class="p">),</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">dat</span><span class="p">))</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span><span class="n">delta</span><span class="p">,</span><span class="n">delta</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">cf</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span><span class="n">zz</span><span class="p">,</span><span class="n">dat</span>
        <span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">levels</span>
        <span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extend</span>
        <span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span>
        <span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span><span class="n">cax</span>
<span class="c1">#        ,ticks=interval[::2]</span>
        <span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="n">sformat</span>
        <span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>

    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#    ax.set_ylim(1,0)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">cbar</span></div>
<div class="viewcode-block" id="zonal_logcontourf"><a class="viewcode-back" href="../gtplot.html#gtplot.zonal_logcontourf">[docs]</a><span class="k">def</span> <span class="nf">zonal_logcontourf</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span><span class="n">zz</span><span class="p">,</span><span class="n">arr</span><span class="p">,</span><span class="n">cnum</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">clabelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
            <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span><span class="n">powerlimits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>\
            <span class="n">dlat</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">subs</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
            <span class="n">replace_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">na_values</span><span class="o">=-</span><span class="mi">999</span><span class="p">,</span>
            <span class="n">timestep</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">xsel</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">cyclic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameter</span>
<span class="sd">    ---------------</span>
<span class="sd">    yy,zz  :array_like</span>
<span class="sd">    xsel   :{int ,string},{index of logitude,&#39;mean&#39;} </span>
<span class="sd">    arr    :array_like</span>
<span class="sd">            input data</span>
<span class="sd">    cnum    :int or float</span>
<span class="sd">            the number of contour</span>
<span class="sd">    powerlimits:tuple</span>
<span class="sd">           exponent range</span>
<span class="sd">     subs   :{sequence of float, &#39;all&#39;,&#39;auto&#39;,None}</span>
<span class="sd">           default=(1,) ex) (1.0,2.0) </span>
<span class="sd">    </span>
<span class="sd">    Return</span>
<span class="sd">    ----------------</span>
<span class="sd">    fig</span>
<span class="sd">    ax</span>
<span class="sd">    cbar</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sformat</span><span class="o">.</span><span class="n">set_powerlimits</span><span class="p">((</span><span class="n">powerlimits</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.05</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">Gtool3d</span><span class="p">):</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">getarr</span><span class="p">(</span><span class="n">cyclic</span><span class="o">=</span><span class="n">cyclic</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,)[:,:,:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">arr</span><span class="p">[:,:,:]</span>
    <span class="k">if</span> <span class="n">xsel</span><span class="o">==</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">dat</span><span class="p">[:,:,:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">dat</span><span class="p">[:,:,</span><span class="n">xsel</span><span class="p">]</span>
    <span class="n">set_latticks</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">dlat</span><span class="o">=</span><span class="n">dlat</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
    <span class="n">cf</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span><span class="n">zz</span><span class="p">,</span><span class="n">dat</span>
        <span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span>
        <span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extend</span>
        <span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span>
        <span class="p">,</span><span class="n">locator</span><span class="o">=</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="n">subs</span><span class="p">)</span>
        <span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span><span class="n">cax</span><span class="p">,</span>
<span class="c1">#        ,ticks=interval[::2]</span>
        <span class="n">ticks</span><span class="o">=</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,)),</span>
        <span class="nb">format</span><span class="o">=</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogFormatterSciNotation</span><span class="p">(),</span>
        <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">cbar</span></div>
<div class="viewcode-block" id="zonal_pcolormesh"><a class="viewcode-back" href="../gtplot.html#gtplot.zonal_pcolormesh">[docs]</a><span class="k">def</span> <span class="nf">zonal_pcolormesh</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span><span class="n">zz</span><span class="p">,</span><span class="n">arr</span><span class="p">,</span><span class="n">cnum</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">clabelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>\
            <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">subs</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span>
            <span class="n">dlat</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">na_values</span><span class="o">=-</span><span class="mi">999</span><span class="p">,</span><span class="n">replace_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">timestep</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">xsel</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">cyclic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameter</span>
<span class="sd">    ---------------</span>
<span class="sd">    yy,zz  :array_like</span>
<span class="sd">    xsel   :{int ,string},{index of logitude,&#39;mean&#39;} </span>
<span class="sd">    arr    :array_like</span>
<span class="sd">            input data</span>
<span class="sd">    cnum    :int or float</span>
<span class="sd">            the number of contour</span>
<span class="sd">    powerlimits:tuple</span>
<span class="sd">           exponent range</span>
<span class="sd">     subs   :{sequence of float, &#39;all&#39;,&#39;auto&#39;,None}</span>
<span class="sd">           default=(1,) ex) (1.0,2.0) </span>
<span class="sd">    </span>
<span class="sd">    Return</span>
<span class="sd">    ----------------</span>
<span class="sd">    fig</span>
<span class="sd">    ax</span>
<span class="sd">    cbar</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sformat</span><span class="o">.</span><span class="n">set_powerlimits</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.05</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">Gtool3d</span><span class="p">):</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">getarr</span><span class="p">(</span><span class="n">cyclic</span><span class="o">=</span><span class="n">cyclic</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,)[:,:,:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">arr</span><span class="p">[:,:,:]</span>
    <span class="k">if</span> <span class="n">xsel</span><span class="o">==</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">dat</span><span class="p">[:,:,:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dat</span><span class="o">=</span><span class="n">dat</span><span class="p">[:,:,</span><span class="n">xsel</span><span class="p">]</span>
    <span class="n">set_latticks</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">dlat</span><span class="o">=</span><span class="n">dlat</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
    <span class="n">norm</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;normal&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;log&#39;</span><span class="p">:</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)}</span>
    <span class="n">cf</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span><span class="n">zz</span><span class="p">,</span><span class="n">dat</span>
        <span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span>
        <span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">[</span><span class="n">scale</span><span class="p">]</span> 
        <span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scale</span><span class="o">==</span><span class="s1">&#39;log&#39;</span><span class="p">:</span>
        <span class="n">cbar</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span><span class="n">cax</span><span class="p">,</span>
            <span class="n">ticks</span><span class="o">=</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="n">subs</span><span class="p">),</span>
            <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span>
            <span class="nb">format</span><span class="o">=</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogFormatterSciNotation</span><span class="p">(),</span>
            <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cbar</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span><span class="n">cax</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">clabelsize</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">cbar</span></div>


<div class="viewcode-block" id="set_axis"><a class="viewcode-back" href="../gtplot.html#gtplot.set_axis">[docs]</a><span class="k">def</span> <span class="nf">set_axis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">labelsize</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="MidpointNormalize"><a class="viewcode-back" href="../gtplot.html#gtplot.MidpointNormalize">[docs]</a><span class="k">class</span> <span class="nc">MidpointNormalize</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">):</span>
    <span class="c1">## class from the mpl docs:</span>
    <span class="c1"># https://matplotlib.org/users/colormapnorms.html</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">midpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">midpoint</span> <span class="o">=</span> <span class="n">midpoint</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">clip</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># I&#39;m ignoring masked values and all kinds of edge cases to make a</span>
        <span class="c1"># simple example...</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">midpoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>    </div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pygtool3  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Author.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.3.
    </div>
  </body>
</html>